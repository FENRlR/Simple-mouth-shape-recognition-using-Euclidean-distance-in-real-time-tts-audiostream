import math
import os
import numpy as np


def spcalc(target, x, y):
    temp = 0
    for i in range(x, y):
        temp += target[i]
    return temp


lipset = ['20', '31', '31', '20', '02']
charset = ['a', 'e', 'i', 'o', 'u']
comp = [
    [0.03926216583841655, 1.386339420932902, 1.4996536664161828],#[0.0359, 1.3005, 1.2910],
    [0.0843672421182286, 1.895435645363557, 4.351767877807027],#[0.1036, 1.6383, 4.5076],
    [0.1400492705745224, 1.969161543996581, 6.14922981262986],#[0.0770, 1.1489, 3.5471],
    [0.063082679399056, 2.7846027790550476, 0.9803437815185027],#[0.1043, 2.7214, 1.0684],
    [0.10214268839349291, 0.9633353297594283, 1.3874174274739213]#[0.0745, 0.7114, 1.1881]
]
def spectralm2(target):  # - receives np.abs(ele)
    """
    01 "closed", 20"open", 31"pressed" , 02"kiss"
    """

    partzero = spcalc(target, 0, 24)
    partone = spcalc(target, 24, 33)
    parttwo = spcalc(target, 33, 65)
    partthree = spcalc(target, 93, 186) #279
    #print(f"RAW : {partzero}, {partone}, {parttwo}, {partthree}")
    #print(f"MOD : {partone/partzero}, {parttwo/partzero}, {partthree/partzero}")
    
    #partzero = spcalc(target, 0, 24)
    partone = partone /partzero
    parttwo = parttwo /partzero
    partthree = partthree /partzero
    op = [partone, parttwo, partthree]

    sqpos = []
    for i in range(len(comp)):
        sqrtsum = 0
        for j in range(3):
            sqrtsum += (comp[i][j] - op[j]) ** 2
        sqpos.append(math.sqrt(sqrtsum))
    # print(f"sqrt : {sqpos}")
    #print(f"detected : {charset[sqpos.index(min(sqpos))]}")

    if partone == 0:
        return "01"
    else:
        return lipset[sqpos.index(min(sqpos))]



"""
a
구간 분석 : [0.0, 0.0, 0.0]
구간 분석 : [124.3963385153816, 450.61456932764963, 2640.8768315454677]
구간 분석 : [11091.89834474379, 88044.40914795108, 124331.95847136564]
구간 분석 : [12418.502069388396, 207516.72261932582, 272319.82878531085]
구간 분석 : [10053.913123399521, 247655.35709516358, 320278.26046807604]
구간 분석 : [10211.153460756364, 255235.40730267816, 317561.2942399584]
구간 분석 : [10526.366529052182, 257261.0810556624, 317524.50473804167]
e
구간 분석 : [0.0, 0.0, 0.0]
구간 분석 : [128.90121744489275, 663.9675493686699, 3183.1814301105205]
구간 분석 : [10530.87840498731, 118724.30931282742, 287869.4213749914]
구간 분석 : [20797.333404744684, 409801.85484818276, 976929.8580624398]
구간 분석 : [24670.512897932378, 644299.6964872896, 1393142.2696691807]
구간 분석 : [28065.135013616484, 723027.3102570062, 1645058.674470137]
구간 분석 : [25950.893460740546, 760564.5865802534, 1728987.9154694844]
i
구간 분석 : [0.0, 0.0, 0.0]
구간 분석 : [152.4489760285852, 609.913964359118, 3131.426357094313]
구간 분석 : [7189.718405073016, 47903.70130998397, 126424.41131113515]
구간 분석 : [17730.48339495249, 208825.54744976497, 557045.2209501546]
구간 분석 : [20932.566244615, 327605.9975523009, 732979.1237369169]
구간 분석 : [21890.877980672212, 435905.83676135645, 861072.1181937291]
구간 분석 : [17404.461503208888, 487675.5836432757, 889703.5920695309]
o
구간 분석 : [0.0, 0.0, 0.0]
구간 분석 : [120.87981668947323, 509.097980681778, 2520.3408764410474]
구간 분석 : [5846.552763150392, 132234.54622306212, 58967.4962443052]
구간 분석 : [6581.526379532696, 348071.66093866905, 147615.9043416803]
구간 분석 : [7767.670411173736, 382571.73952612054, 169597.60628945124]
구간 분석 : [9492.807002466252, 393713.05774447694, 163953.5195723385]
u
구간 분석 : [0.0, 0.0, 0.0]
구간 분석 : [159.91990178953296, 567.4314803718125, 2677.566625722816]
구간 분석 : [5435.72342487054, 68635.6598596918, 98719.35029074049]
구간 분석 : [18984.125666503976, 264720.72725499544, 409494.4725877489]
구간 분석 : [34648.4587579521, 420609.7428180356, 754069.9949793904]
구간 분석 : [47188.36849837771, 493575.39769660105, 818581.2881430228]
구간 분석 : [51588.61736982357, 518526.39720988163, 810228.5293183661]

あ 아a - 2차
え 에e - 3차
い 이i - 3차
お 오o - 2차
う 우u - 1차

01 "closed", 20"open", 31"pressed" , 02"kiss" -> 무음상태를 포함하므로 실질적으로 3개의 항목으로 분류


u - 1차 구간 "kiss"
500~700
순위 - u, i, e, o, a

o, a - 2차 구간 "open"
700~1800
순위 - o, a, e, u, i

e, i -3차 구간 "pressed"
1800~6000
순위 - i, e, o, a, u



mix : aeiou
xele : 1024
구간 분석 : [124001.3188568087, 2563137.42267428, 4593894.378404058]


a
xele : 1024
구간 분석 : [9218.052278124955, 287063.94954373204, 295250.6513722204]
e
xele : 1024
구간 분석 : [19346.27602931841, 556505.1365346218, 1058694.9310033857]
i
xele : 1024
구간 분석 : [21165.348959982846, 426148.86234808154, 1002694.6191377665]
o
xele : 1024
구간 분석 : [8618.498431365271, 363618.7254785794, 121434.7089879088]
u
xele : 1024
구간 분석 : [44760.47024735328, 612548.9205287566, 1058218.4720417506]


"""
